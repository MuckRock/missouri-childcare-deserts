library(sf)
library(lubridate)
library(tmap)
# The code below caches the zip code tabulation data we want from the Census
options(tigris_use_cache = TRUE)
# Load all relief data with cleaned zips and years for when and where money was dispersed to
relief_funding <- read_csv(here("data", "processed", "all_relief_cleaned.csv")) %>%
mutate(zip = as.character(zip))
# Zip code to zcta crosswalk file from UDS Mapper
zip_zcta_crosswalk <- read_excel(here("data", "raw", "ZIPCodetoZCTACrosswalk2021UDS.xlsx"), sheet = 1) %>%
clean_names()
# Join crosswalk with relief funding zips to that each zip matches a zcta to correspond to desert data
# Success! All zips found a zcta
relief_zcta <- relief_funding %>%
inner_join(zip_zcta_crosswalk, by = c("zip" = "zip_code"))
# Load cleaned and crosswalked data
capacity_data <- read_csv(here("data", "processed", "ChildCareAware_cleaned_and_crosswalked.csv"))
# Filter the capacity deserts to data from 2021 and 2022, aggregate the bi-yearly data to yearly, and remove non-desert zctas
zcta_deserts <- capacity_data %>%
select(zcta, year, month, licensed_capacity, pop_5_and_under) %>%
filter(year %in% c("2021", "2022")) %>%
group_by(zcta, year) %>%
summarize(ratio = sum(pop_5_and_under) / sum(licensed_capacity)) %>%
filter(ratio >= 3)  %>%
mutate(zcta = as.character(zcta))
# This join is for all funding together
relief_to_desert_join <- relief_zcta %>%
group_by(zcta, year) %>%
summarize(total = sum(amount)) %>%
left_join(zcta_deserts, by = c("zcta", "year")) %>%
mutate(status = case_when(is.na(ratio) ~ "non-desert", TRUE ~ "desert"))
# The big reveal
total <-  relief_to_desert_join %>%
group_by(status) %>%
summarize(total = sum(total))
# This join is for funding my source
relief_to_desert_type_join <- relief_zcta %>%
group_by(zcta, year, type) %>%
summarize(total = sum(amount)) %>%
left_join(zcta_deserts, by = c("zcta", "year")) %>%
mutate(status = case_when(is.na(ratio) ~ "non-desert", TRUE ~ "desert")) %>%
group_by(type, status) %>%
summarize(total = sum(total)) %>%
pivot_wider(names_from = status, values_from = total)
# Finding top 10 deserts with most kids and least money
# Join back to zcta deserts to get number of children by zip
top_10_w_money <- relief_to_desert_join %>%
filter(status == "desert") %>%
select(-ratio) %>%
inner_join(zcta_deserts, by = c("zcta", "year")) %>%
mutate(money_pop_ratio = total/pop_5_and_under) %>%
filter(money_pop_ratio <= 26)
View(relief_to_desert_join)
# This join is for all funding together
relief_to_desert_join <- relief_zcta %>%
group_by(zcta, year)
View(relief_to_desert_join)
library(tidyverse)
library(janitor)
library(readxl)
library(tidycensus)
library(here)
library(sf)
library(lubridate)
library(tmap)
# The code below caches the zip code tabulation data we want from the Census
options(tigris_use_cache = TRUE)
# Load all relief data with cleaned zips and years for when and where money was dispersed to
relief_funding <- read_csv(here("data", "processed", "all_relief_cleaned.csv")) %>%
mutate(zip = as.character(zip))
# Zip code to zcta crosswalk file from UDS Mapper
zip_zcta_crosswalk <- read_excel(here("data", "raw", "ZIPCodetoZCTACrosswalk2021UDS.xlsx"), sheet = 1) %>%
clean_names()
# Join crosswalk with relief funding zips to that each zip matches a zcta to correspond to desert data
# Success! All zips found a zcta
relief_zcta <- relief_funding %>%
inner_join(zip_zcta_crosswalk, by = c("zip" = "zip_code"))
# Load cleaned and crosswalked data
capacity_data <- read_csv(here("data", "processed", "ChildCareAware_cleaned_and_crosswalked.csv"))
# Filter the capacity deserts to data from 2021 and 2022, aggregate the bi-yearly data to yearly, and remove non-desert zctas
zcta_deserts <- capacity_data %>%
select(zcta, year, month, licensed_capacity, pop_5_and_under) %>%
filter(year %in% c("2021", "2022")) %>%
group_by(zcta, year) %>%
summarize(ratio = sum(pop_5_and_under) / sum(licensed_capacity)) %>%
filter(ratio >= 3)  %>%
mutate(zcta = as.character(zcta))
View(relief_zcta)
# This join is for all funding together
relief_to_desert_join <- relief_zcta %>%
group_by(zcta, year) %>%
summarize(total = sum(amount)) %>%
left_join(zcta_deserts, by = c("zcta", "year")) %>%
mutate(status = case_when(is.na(ratio) ~ "non-desert", TRUE ~ "desert"))
View(relief_zcta)
View(relief_to_desert_join)
# Finding top 10 deserts with most kids and least money
# Join back to zcta deserts to get number of children by zip
top_10_w_money <- relief_to_desert_join %>%
filter(status == "desert") %>%
select(-ratio) %>%
inner_join(zcta_deserts, by = c("zcta", "year")) %>%
mutate(money_pop_ratio = total/pop_5_and_under) %>%
filter(money_pop_ratio <= 26)
View(zcta_deserts)
View(zcta_deserts)
# Filter the capacity deserts to data from 2021 and 2022, aggregate the bi-yearly data to yearly, and remove non-desert zctas
zcta_deserts <- capacity_data %>%
select(zcta, year, month, licensed_capacity, pop_5_and_under) %>%
filter(year %in% c("2021", "2022")) %>%
group_by(zcta, year) %>%
summarize(ratio = sum(pop_5_and_under) / sum(licensed_capacity), pop_5_and_under = sum(pop_5_and_under)) %>%
filter(ratio >= 3)  %>%
mutate(zcta = as.character(zcta))
View(zcta_deserts)
# Finding top 10 deserts with most kids and least money
# Join back to zcta deserts to get number of children by zip
top_10_w_money <- relief_to_desert_join %>%
filter(status == "desert") %>%
select(-ratio) %>%
inner_join(zcta_deserts, by = c("zcta", "year")) %>%
mutate(money_pop_ratio = total/pop_5_and_under) %>%
filter(money_pop_ratio <= 26)
top_10_all <- zcta_deserts %>%
left_join(select(top_10_w_money, total, money_pop_ratio), by = "zcta") %>%
filter(ratio > 10) %>%
filter(pop_5_and_under > 500)
View(top_10_all)
View(top_10_w_money)
# Finding top 10 deserts with most kids and least money
# Join back to zcta deserts to get number of children by zip
top_10_w_money <- relief_to_desert_join %>%
filter(status == "desert") %>%
select(-ratio) %>%
inner_join(zcta_deserts, by = c("zcta", "year")) %>%
mutate(money_pop_ratio = total/pop_5_and_under) %>%
filter(money_pop_ratio <= 26)
# First quartile is between 1.646 and 26.132
summary(top_10$money_pop_ratio)
top_10_all <- zcta_deserts %>%
left_join(select(top_10_w_money, total, money_pop_ratio), by = "zcta") %>%
filter(ratio > 10) %>%
filter(pop_5_and_under > 500)
# Filter the capacity deserts to data from 2021 and 2022, aggregate the bi-yearly data to yearly, and remove non-desert zctas
zcta_deserts <- capacity_data %>%
select(zcta, year, month, licensed_capacity, pop_5_and_under) %>%
filter(year %in% c("2021", "2022")) %>%
group_by(zcta, year) %>%
summarize(ratio = sum(pop_5_and_under) / sum(licensed_capacity)) %>%
filter(ratio >= 3)  %>%
mutate(zcta = as.character(zcta))
View(zcta_deserts)
View(zip_zcta_crosswalk)
View(capacity_data)
# Finding top 10 deserts with most kids and least money
# Join back to zcta deserts to get number of children by zip
top_10_w_money <- relief_to_desert_join %>%
filter(status == "desert") %>%
select(-ratio)
View(top_10_w_money)
# 5 year ACS estimates pf population five and under for all zctas in the country
acs <- read_csv(here("data", "processed", "pop_zcta_5acs.csv"))
# Finding top 10 deserts with most kids and least money
# Join back to zcta deserts to get number of children by zip
top_10_w_money <- relief_to_desert_join %>%
filter(status == "desert") %>%
select(-ratio)
View(top_10_w_money)
View(zcta_deserts)
df <- capacity_data %>%
select(zcta, year, month, licensed_capacity, pop_5_and_under) %>%
filter(year %in% c("2021", "2022")) %>%
group_by(zcta, year) %>%
summarize(ratio = sum(pop_5_and_under) / sum(licensed_capacity)) %>%
filter(ratio >= 3)  %>%
mutate(zcta = as.character(zcta))
View(df)
View(acs)
df <- zcta_deserts %>%
inner_join(acs, by = c("zcta" = "GEOID"))
df <- zcta_deserts %>%
inner_join(select(acs, pop_5_and_under), by = c("zcta" = "GEOID"))
df <- zcta_deserts %>%
inner_join(select(acs, GEOID, pop_5_and_under), by = c("zcta" = "GEOID"))
View(relief_to_desert_join)
View(relief_zcta)
df <- zcta_deserts %>%
inner_join(select(acs, GEOID, pop_5_and_under), by = c("zcta" = "GEOID")) %>%
inner(relief_to_desert_join, by = "zcta")
df <- zcta_deserts %>%
inner_join(select(acs, GEOID, pop_5_and_under), by = c("zcta" = "GEOID")) %>%
inner_join(relief_to_desert_join, by = "zcta")
df <- zcta_deserts %>%
inner_join(select(acs, GEOID, pop_5_and_under), by = c("zcta" = "GEOID")) %>%
left_join(relief_to_desert_join, by = "zcta")
View(df)
df <- zcta_deserts %>%
inner_join(select(acs, GEOID, pop_5_and_under), by = c("zcta" = "GEOID"))
# Join deserts with their ACS numbers and then back to relief funding
df <- zcta_deserts %>%
inner_join(select(acs, GEOID, pop_5_and_under), by = c("zcta" = "GEOID"))
left_join(select(relief_to_desert_join, total), by = c("zcta", "year"))
# Join deserts with their ACS numbers and then back to relief funding
df <- zcta_deserts %>%
inner_join(select(acs, GEOID, pop_5_and_under), by = c("zcta" = "GEOID"))
left_join(select(relief_to_desert_join, zcta, year, total), by = c("zcta", "year"))
df <- zcta_deserts %>%
inner_join(select(acs, GEOID, pop_5_and_under), by = c("zcta" = "GEOID")) %>%
left_join(select(relief_to_desert_join, zcta, year, total), by = c("zcta", "year"))
View(zcta_deserts)
View(capacity_data)
df_pandemic <- df %>%
group_by(zcta) %>%
summarize(total_money = sum(total, na.rm = TRUE))
View(df_pandemic)
n_distinct(df$zcta)
df <- zcta_deserts %>%
inner_join(select(acs, GEOID, pop_5_and_under), by = c("zcta" = "GEOID")) %>%
left_join(select(relief_to_desert_join, zcta, year, total), by = c("zcta", "year")) %>%
mutate(total = case_when(is.na(total) ~ 0, total))
df <- zcta_deserts %>%
inner_join(select(acs, GEOID, pop_5_and_under), by = c("zcta" = "GEOID")) %>%
left_join(select(relief_to_desert_join, zcta, year, total), by = c("zcta", "year")) %>%
mutate(total = case_when(is.na(total) ~ 0, TRUE ~ total))
View(df)
df_pandemic <- df %>%
group_by(zcta) %>%
summarize(total_money = sum(total), pop_5_and_under = sum(pop_5_and_under))
df_pandemic <- df %>%
group_by(zcta) %>%
summarize(total_money = sum(total), pop_5_and_under = sum(pop_5_and_under), ratio = mean(ratio))
df_pandemic <- df %>%
group_by(zcta) %>%
summarize(ratio = mean(ratio), total_money = sum(total), pop_5_and_under = sum(pop_5_and_under))
df_pandemic <- df %>%
group_by(zcta) %>%
summarize(ratio = mean(ratio), total_money = sum(total), pop_5_and_under = sum(pop_5_and_under)) %>%
mutate(dollars_per_child = total_money/pop_5_and_under)
summary(df_pandemic$dollars_per_child)
df_pandemic <- df %>%
group_by(zcta) %>%
summarize(ratio = mean(ratio), total_money = sum(total), pop_5_and_under = sum(pop_5_and_under)) %>%
mutate(dollars_per_child = total_money/pop_5_and_under) %>%
filter(dollars_per_child <= 24 )
df_pandemic <- df %>%
group_by(zcta) %>%
summarize(ratio = mean(ratio), total_money = sum(total), pop_5_and_under = mean(pop_5_and_under)) %>%
mutate(dollars_per_child = total_money/pop_5_and_under) %>%
filter(dollars_per_child <= 24 )
df_pandemic <- df %>%
group_by(zcta) %>%
summarize(ratio = mean(ratio), total_money = sum(total), pop_5_and_under = mean(pop_5_and_under)) %>%
mutate(dollars_per_child = total_money/pop_5_and_under)
# Less than median is 24
summary(df_pandemic$dollars_per_child)
df_pandemic <- df %>%
group_by(zcta) %>%
summarize(ratio = mean(ratio), total_money = sum(total), pop_5_and_under = mean(pop_5_and_under)) %>%
mutate(dollars_per_child = total_money/pop_5_and_under) %>%
filter(dollars_per_child <= 48)
library(tidyverse)
library(janitor)
library(readxl)
library(tidycensus)
library(here)
library(sf)
library(lubridate)
library(tmap)
# The code below caches the zip code tabulation data we want from the Census
options(tigris_use_cache = TRUE)
# Cleaned and crosswalked ChildCareAware data
capacity_data <- read_csv(here("data", "processed", "ChildCareAware_cleaned_and_crosswalked.csv"))
# 5 year ACS estimates pf population five and under for all zctas in the country
acs <- read_csv(here("data", "processed", "pop_zcta_5acs.csv"))
# Zcta to zipcode crosswalk that covers all the zctas in Missouri
mo_zctas <- read_excel(here("data", "raw", "ZIPCodetoZCTACrosswalk2021UDS.xlsx"), sheet = 1) %>%
clean_names() %>%
filter(state == "MO") %>%
distinct(zcta)
deserts_2023 <- capacity_data %>%
select(zcta, year, month, licensed_capacity, pop_5_and_under) %>%
filter(year == "2023") %>%
mutate(ratio = pop_5_and_under / licensed_capacity) %>%
filter(ratio >= 3)
# 171,048 in 227 zctas that are childcare deserts
sum(deserts_2023$pop_5_and_under)
# 5 zctas didn't join ?
mo_zctas_with_pop <- mo_zctas %>%
left_join(acs, by = c("zcta" = "GEOID"))
#  442,254 children under 5 or under across the state
sum(mo_zctas_with_pop$pop_5_and_under, na.rm=TRUE)
crrsa_startup_expansion <-  read_excel(here("data","raw", "CRRSA Startup and Expansion with Paid.xlsx")) %>%
clean_names()
View(crrsa_startup_expansion)
colnames(crrsa_startup_expansion)
age_breakouts <- crrsa_startup_expansion %>%
select(dvn, number_of_infant_toddler_slots_adding, number_of_preschool_slots_adding, number_of_school_age_slots_adding, total_anticipated_capacity)
View(age_breakouts)
age_breakouts <- crrsa_startup_expansion %>%
select(dvn, number_of_infant_toddler_slots_adding, number_of_preschool_slots_adding, number_of_school_age_slots_adding, total_anticipated_capacity) %>%
mutate(slots = sum(number_of_infant_toddler_slots_adding, number_of_preschool_slots_adding, number_of_school_age_slots_adding))
age_breakouts <- crrsa_startup_expansion %>%
select(dvn, number_of_infant_toddler_slots_adding, number_of_preschool_slots_adding, number_of_school_age_slots_adding, total_anticipated_capacity) %>%
mutate(slots = number_of_infant_toddler_slots_adding + number_of_preschool_slots_adding + number_of_school_age_slots_adding)
str(crrsa_startup_expansion)
colnames(crrsa_startup_expansion)
test <- crrsa_startup_expansion %>%
select(dvn, at_startup, at_expansion, at_enhancement)
View(test)
age_breakouts <- crrsa_startup_expansion %>%
select(dvn, number_of_infant_toddler_slots_adding, number_of_preschool_slots_adding, number_of_school_age_slots_adding, total_anticipated_capacity) %>%
mutate(slots = number_of_infant_toddler_slots_adding + number_of_preschool_slots_adding + number_of_school_age_slots_adding) %>%
filter(slots > total_anticipated_capacity)
library(tidyverse)
library(janitor)
library(readxl)
library(tidycensus)
library(here)
library(sf)
library(lubridate)
library(tmap)
# Cache the zip code tabulation data we want from the Census
options(tigris_use_cache = TRUE)
# Sets tmap to interactive mode
tmap_mode("view")
# LOAD DATA
# Load clean and crosswalked data for all zctas from ChildCareAware survey
# There are 475 unique zctas for 2023 in the data
survey_data <- read_csv(here("data", "processed", "ChildCareAware_cleaned_and_crosswalked.csv")) %>%
mutate(zcta = as.character(zcta)) %>%
filter(year == 2023)
# Load all zctas not included in ChildCareAware survey
# There are 1023 unique zctas in MO according to thise crosswalk
mo_zctas <- read_excel(here("data", "raw", "ZIPCodetoZCTACrosswalk2021UDS.xlsx"), sheet = 1) %>%
clean_names() %>%
filter(state == "MO") %>%
distinct(zcta)
# Add back in all zctas not included in survey so that we can map them all together
map_df <-  survey_data %>%
right_join(mo_zctas, by = "zcta") %>%
mutate(ratio = pop_5_and_under / licensed_capacity) %>%
mutate(status = case_when(is.na(ratio) ~ "non-desert", ratio < 3 ~ "non-desert", ratio >= 3 & ratio < 10 ~ "desert", ratio >= 10 ~ "extreme", TRUE ~ "test")) %>%
mutate(status_num = case_when(is.na(ratio) ~ 0, ratio < 3 ~ 0, ratio >= 3 & ratio < 10 ~ 1, ratio >= 10 ~ 2, TRUE ~ 0)) %>%
select(zcta, status, status_num, ratio)
# LOAD DATA
# Load clean and crosswalked data for all zctas from ChildCareAware survey
# There are 475 unique zctas for 2023 in the data
childcare_aware <- read_csv(here("data", "processed", "ChildCareAware_cleaned_and_crosswalked.csv")) %>%
mutate(zcta = as.character(zcta))
childcare_aware_2023 <- childcare_aware %>%
filter(year == 2023)
# Load all zctas not included in ChildCareAware survey
# There are 1023 unique zctas in MO according to thise crosswalk
mo_zctas <- read_excel(here("data", "raw", "ZIPCodetoZCTACrosswalk2021UDS.xlsx"), sheet = 1) %>%
clean_names() %>%
filter(state == "MO") %>%
distinct(zcta)
# Add back in all zctas not included in survey so that we can map them all together
map_df <-  childcare_aware_2023 %>%
right_join(mo_zctas, by = "zcta") %>%
mutate(ratio = pop_5_and_under / licensed_capacity) %>%
mutate(status = case_when(is.na(ratio) ~ "non-desert", ratio < 3 ~ "non-desert", ratio >= 3 & ratio < 10 ~ "desert", ratio >= 10 ~ "extreme", TRUE ~ "test")) %>%
mutate(status_num = case_when(is.na(ratio) ~ 0, ratio < 3 ~ 0, ratio >= 3 & ratio < 10 ~ 1, ratio >= 10 ~ 2, TRUE ~ 0)) %>%
select(zcta, status, status_num, ratio)
deserts_2023 <- childcare_aware %>%
select(zcta, year, month, licensed_capacity, pop_5_and_under) %>%
filter(year == "2023") %>%
mutate(ratio = pop_5_and_under / licensed_capacity) %>%
filter(ratio >= 3)
# 171,048 in 227 zctas that are childcare deserts
sum(deserts_2023$pop_5_and_under)
# Same five ZCTAs didn't join, but again, these are non-deserts PO boxes anyway
mo_zctas_with_pop <- mo_zctas %>%
left_join(acs, by = c("zcta" = "GEOID"))
# 5 year ACS estimates pf population five and under for all zctas in the country
acs <- read_csv(here("data", "processed", "pop_zcta_5acs.csv"))
View(acs)
# Same five ZCTAs didn't join, but again, these are non-deserts PO boxes anyway
mo_zctas_with_pop <- mo_zctas %>%
left_join(acs, by = c("zcta" = "GEOID"))
#  442,254 children under 5 or under across the state
sum(mo_zctas_with_pop$pop_5_and_under, na.rm=TRUE)
View(deserts_2023)
View(deserts_2023)
View(mo_zctas_with_pop)
yearly_deserts <- childcare_aware %>%
mutate(ratio = pop_5_and_under / licensed_capacity) %>%
filter(ratio >= 3) %>%
group_by(year, month) %>%
summarize(children_in_deserts = sum(pop_5_and_under), num_programs = sum(childcare_programs))
# In 2020, the number of children in childcare deserts was the highest among the last several years.
View(yearly_deserts)
View(childcare_aware)
num_programs_yearly <- childcare_aware %>%
group_by(year, month) %>%
summarize(num_program = sum(num_program))
num_programs_yearly <- childcare_aware %>%
group_by(year, month) %>%
summarize(num_program = sum(childcare_programs))
View(num_programs_yearly)
View(yearly_deserts)
crrsa_startup_expansion <-  read_excel(here("data","raw", "CRRSA Startup and Expansion with Paid.xlsx")) %>%
clean_names()
View(crrsa_startup_expansion)
age_breakouts <- crrsa_startup_expansion %>%
select(number_of_infant_toddler_slots_adding, number_of_preschool_slots_adding, number_of_school_age_slots_adding) %>%
mutate_all(~replace(., is.na(.), 0)) %>%
pivot_longer(number_of_infant_toddler_slots_adding:number_of_school_age_slots_adding, names_to = "age_group", values_to = "number")%>%
group_by(age_group) %>%
summarize(number = sum(number))
View(age_breakouts)
real_capacity <- crrsa_startup_expansion %>%
select(dvn, at_startup, number_of_infant_toddler_slots_adding, number_of_preschool_slots_adding, number_of_school_age_slots_adding, total_anticipated_capacity) %>%
mutate(slots = number_of_infant_toddler_slots_adding + number_of_preschool_slots_adding + number_of_school_age_slots_adding) %>%
filter(slots > total_anticipated_capacity)
View(real_capacity)
# Zip code to zcta crosswalk file from UDS Mapper
zip_zcta_crosswalk <- read_excel(here("data", "raw", "ZIPCodetoZCTACrosswalk2021UDS.xlsx"), sheet = 1) %>%
clean_names()
# Join crosswalk with relief funding zips to that each zip matches a zcta to correspond to desert data
# Success! All zips found a zcta
relief_zcta <- relief_funding %>%
inner_join(zip_zcta_crosswalk, by = c("zip" = "zip_code"))
# Load all relief data with cleaned zips and years for when and where money was dispersed to
relief_funding <- read_csv(here("data", "processed", "all_relief_cleaned.csv")) %>%
mutate(zip = as.character(zip))
# Join crosswalk with relief funding zips to that each zip matches a zcta to correspond to desert data
# Success! All zips found a zcta
relief_zcta <- relief_funding %>%
inner_join(zip_zcta_crosswalk, by = c("zip" = "zip_code"))
# Filter the capacity deserts to data from 2021 and 2022, aggregate the bi-yearly data to yearly, and remove non-desert zctas
childcare_aware_2021_2022 <- childcare_aware %>%
select(zcta, year, month, licensed_capacity, pop_5_and_under) %>%
filter(year %in% c("2021", "2022")) %>%
group_by(zcta, year) %>%
summarize(ratio = sum(pop_5_and_under) / sum(licensed_capacity)) %>%
filter(ratio >= 3)  %>%
mutate(zcta = as.character(zcta))
# This join is for all funding together
relief_to_desert_join <- relief_zcta %>%
group_by(zcta, year) %>%
summarize(total = sum(amount)) %>%
left_join(childcare_aware_2021_2022, by = c("zcta", "year")) %>%
mutate(status = case_when(is.na(ratio) ~ "non-desert", TRUE ~ "desert"))
# The big reveal
total <-  relief_to_desert_join %>%
group_by(status) %>%
summarize(total = sum(total))
View(total)
# This join is for funding my source
relief_to_desert_type_join <- relief_zcta %>%
group_by(zcta, year, type) %>%
summarize(total = sum(amount)) %>%
left_join(zcta_deserts, by = c("zcta", "year")) %>%
mutate(status = case_when(is.na(ratio) ~ "non-desert", TRUE ~ "desert")) %>%
group_by(type, status) %>%
summarize(total = sum(total)) %>%
pivot_wider(names_from = status, values_from = total)
# This join is for funding my source
relief_to_desert_type_join <- relief_zcta %>%
group_by(zcta, year, type) %>%
summarize(total = sum(amount)) %>%
left_join(childcare_aware_2021_2022, by = c("zcta", "year")) %>%
mutate(status = case_when(is.na(ratio) ~ "non-desert", TRUE ~ "desert")) %>%
group_by(type, status) %>%
summarize(total = sum(total)) %>%
pivot_wider(names_from = status, values_from = total)
View(relief_to_desert_type_join)
View(total)
View(relief_to_desert_join)
View(relief_to_desert_join)
View(childcare_aware_2021_2022)
View(childcare_aware_2023)
# Filter the capacity deserts to data from 2021 and 2022, aggregate the bi-yearly data to yearly, and remove non-desert zctas
childcare_aware_2021_2022 <- childcare_aware %>%
select(zcta, year, month, licensed_capacity, pop_5_and_under) %>%
filter(year %in% c("2021", "2022")) %>%
group_by(zcta, year)
# Filter the capacity deserts to data from 2021 and 2022, aggregate the bi-yearly data to yearly, and remove non-desert zctas
childcare_aware_2021_2022 <- childcare_aware %>%
select(zcta, year, month, licensed_capacity, pop_5_and_under) %>%
filter(year %in% c("2021", "2022")) %>%
group_by(zcta, year)  %>%
summarize(ratio = sum(pop_5_and_under, na.rm = TRUE) / sum(licensed_capacity, na.rm = TRUE)) %>%
filter(ratio >= 3)  %>%
mutate(zcta = as.character(zcta))
# This join is for all funding together
relief_to_desert_join <- relief_zcta %>%
group_by(zcta, year) %>%
summarize(total = sum(amount)) %>%
left_join(childcare_aware_2021_2022, by = c("zcta", "year")) %>%
mutate(status = case_when(is.na(ratio) ~ "non-desert", TRUE ~ "desert"))
# The big reveal
total_desert_relief <-  relief_to_desert_join %>%
group_by(status) %>%
summarize(total = sum(total))
View(total)
# Filter the capacity deserts to data from 2021 and 2022, aggregate the bi-yearly data to yearly, and remove non-desert zctas
childcare_aware_2021_2022 <- childcare_aware %>%
select(zcta, year, month, licensed_capacity, pop_5_and_under) %>%
filter(year %in% c("2021", "2022")) %>%
group_by(zcta, year)  %>%
summarize(ratio = sum(pop_5_and_under, na.rm = TRUE) / sum(licensed_capacity, na.rm = TRUE), pop_5_and_under = mean(pop_5_and_under)) %>%
filter(ratio >= 3)  %>%
mutate(zcta = as.character(zcta))
View(childcare_aware)
# This join is for all funding together
relief_to_desert_join <- relief_zcta %>%
group_by(zcta, year) %>%
summarize(total = sum(amount)) %>%
left_join(childcare_aware_2021_2022, by = c("zcta", "year")) %>%
mutate(status = case_when(is.na(ratio) ~ "non-desert", TRUE ~ "desert"))
